# ğŸ“Š Visual Guide: Smart Routing & Risk-Based Pricing

## System Architecture Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        CUSTOMER FRONTEND                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Quote Form (Step 2)                                     â”‚  â”‚
â”‚  â”‚  â€¢ Address selection                                     â”‚  â”‚
â”‚  â”‚  â€¢ Story count (1, 2, 3+)                                â”‚  â”‚
â”‚  â”‚  â€¢ â˜… MATERIAL selection (Vinyl/Brick/Stucco)            â”‚  â”‚
â”‚  â”‚  â€¢ Add-ons selection                                     â”‚  â”‚
â”‚  â”‚  â€¢ Email entry                                           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚ POST /api/quote
                     â”‚ {address, stories, material, ...}
                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      API BACKEND (route.ts)                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  1. Input Validation                                     â”‚  â”‚
â”‚  â”‚     âœ“ Required fields present                            â”‚  â”‚
â”‚  â”‚     âœ“ Email format valid                                 â”‚  â”‚
â”‚  â”‚     âœ“ Estate check (>4500 sq ft)                         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                     â†“                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  2. Smart Routing: calculateRouting(address)             â”‚  â”‚
â”‚  â”‚     â”œâ”€ Call Google Maps Distance Matrix API             â”‚  â”‚
â”‚  â”‚     â”œâ”€ Get distance in km                               â”‚  â”‚
â”‚  â”‚     â”œâ”€ REJECTION: Is distance > 45km? âŒ â†’ Return Error â”‚  â”‚
â”‚  â”‚     â”œâ”€ SURCHARGE: Is distance > 20km?                   â”‚  â”‚
â”‚  â”‚     â”‚  â””â”€ Calculate: (distance - 20) Ã— $2.50            â”‚  â”‚
â”‚  â”‚     â””â”€ Return: { distance, duration, travelSurcharge }  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                     â†“                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  3. Risk-Based Pricing: calculateQuoteWithMaterial()     â”‚  â”‚
â”‚  â”‚     â”œâ”€ Get Base Rate (by stories)                        â”‚  â”‚
â”‚  â”‚     â”œâ”€ Apply Material Multiplier:                        â”‚  â”‚
â”‚  â”‚     â”‚  â€¢ Vinyl (1.0x) â†’ No markup                        â”‚  â”‚
â”‚  â”‚     â”‚  â€¢ Brick (1.1x) â†’ +10%                             â”‚  â”‚
â”‚  â”‚     â”‚  â€¢ Stucco (1.35x) â†’ +35%                           â”‚  â”‚
â”‚  â”‚     â”œâ”€ Calculate Subtotal = Base Ã— Multiplier            â”‚  â”‚
â”‚  â”‚     â”œâ”€ Add Travel Surcharge                              â”‚  â”‚
â”‚  â”‚     â”œâ”€ Apply 15% margin for range                        â”‚  â”‚
â”‚  â”‚     â””â”€ Return: Breakdown with all components             â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                     â†“                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  4. Send Response + Emails                               â”‚  â”‚
â”‚  â”‚     â”œâ”€ Return JSON with breakdown to frontend            â”‚  â”‚
â”‚  â”‚     â”œâ”€ Send Admin Email (with distance/surcharge)        â”‚  â”‚
â”‚  â”‚     â””â”€ Send Customer Email (with breakdown table)        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚ Response: {minPrice, maxPrice, breakdown}
                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CUSTOMER FRONTEND DISPLAY                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Your Estimated Price                                   â”‚  â”‚
â”‚  â”‚  $ 688 - $ 791                                          â”‚  â”‚
â”‚  â”‚                                                          â”‚  â”‚
â”‚  â”‚  Price Breakdown                                        â”‚  â”‚
â”‚  â”‚  Base Service (2 stories)        $500.00               â”‚  â”‚
â”‚  â”‚  Stucco Material Surcharge       +$175.00              â”‚  â”‚
â”‚  â”‚  Travel Surcharge (22km)         +$12.50               â”‚  â”‚
â”‚  â”‚                                                          â”‚  â”‚
â”‚  â”‚  Distance: 22 km                                        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Pricing Calculation Flow

```
INPUTS:
  â€¢ Stories: 2
  â€¢ Material: Stucco
  â€¢ Distance: 25km
  â€¢ Email: customer@example.com

        â†“

STEP 1: GET BASE RATE
  Stories = 2 â†’ Base Rate = $500

        â†“

STEP 2: APPLY MATERIAL MULTIPLIER
  Material = Stucco â†’ Multiplier = 1.35x
  Material Surcharge = $500 Ã— (1.35 - 1.0) = $175
  Subtotal = $500 Ã— 1.35 = $675

        â†“

STEP 3: CALCULATE TRAVEL SURCHARGE
  Distance = 25km > 20km threshold
  Excess Distance = 25 - 20 = 5km
  Travel Surcharge = 5 Ã— $2.50 = $12.50

        â†“

STEP 4: TOTAL & MARGIN
  Total = $675 + $12.50 = $687.50
  Min Price = $688 (rounded)
  Max Price = $688 Ã— 1.15 = $791

        â†“

OUTPUTS:
  âœ“ minPrice: 688
  âœ“ maxPrice: 791
  âœ“ breakdown: {
      basePrice: 500,
      materialSurcharge: 175,
      travelSurcharge: 12.50
    }
  âœ“ routing: {
      distance: 25,
      duration: "30 mins",
      travelSurcharge: 12.50
    }
```

## Distance Decision Tree

```
Address entered by customer
        â”‚
        â†“ Google Maps API call
        â”‚
   Is distance valid?
   â”œâ”€ NO â†’ Return "Invalid Address" error
   â””â”€ YES â†’ Continue
        â”‚
        â†“ Check distance threshold
        â”‚
   Is distance > 45km?
   â”œâ”€ YES â†’ âŒ REJECT
   â”‚       â””â”€ Return "Outside service area" error
   â”‚       â””â”€ No quote generated
   â”‚       â””â”€ Email status: FAIL
   â”‚
   â””â”€ NO â†’ âœ“ ACCEPT
           â”‚
           â†“ Check surcharge threshold
           â”‚
       Is distance > 20km?
       â”œâ”€ YES â†’ Apply surcharge
       â”‚       â””â”€ Surcharge = (distance - 20) Ã— $2.50
       â”‚       â””â”€ Continue with quote
       â”‚
       â””â”€ NO â†’ No surcharge
               â””â”€ Surcharge = $0
               â””â”€ Continue with quote
               â”‚
               â†“
           âœ“ Quote generated
           âœ“ Both emails sent
```

## Material Risk Levels

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    MATERIAL MATRIX                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Material     â”‚ Multiplier   â”‚ Surchargeâ”‚ Risk Level      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Vinyl        â”‚ 1.0x         â”‚ None     â”‚ âšª Standard     â”‚
â”‚              â”‚              â”‚          â”‚ - Most common   â”‚
â”‚              â”‚              â”‚          â”‚ - Easy to wash  â”‚
â”‚              â”‚              â”‚          â”‚                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Brick        â”‚ 1.1x         â”‚ +10%     â”‚ ğŸŸ¡ Moderate     â”‚
â”‚              â”‚              â”‚          â”‚ - Hard surface  â”‚
â”‚              â”‚              â”‚          â”‚ - Care needed   â”‚
â”‚              â”‚              â”‚          â”‚                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Stucco       â”‚ 1.35x        â”‚ +35%     â”‚ ğŸ”´ High Risk    â”‚
â”‚              â”‚              â”‚          â”‚ - Very delicate â”‚
â”‚              â”‚              â”‚          â”‚ - Special care  â”‚
â”‚              â”‚              â”‚          â”‚ - Damage prone  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Why the difference?

Vinyl:  âœ“ Durable
        âœ“ Forgiving
        âœ“ Fast to wash
        â†’ Standard rate

Brick:  âš  Porous surface
        âš  Can stain if not sealed
        âš  Pressure must be managed
        â†’ 10% markup for extra care

Stucco: âš âš  Very delicate
        âš âš  Easily damaged/cracked
        âš âš  Specialized equipment needed
        âš âš  High warranty risk
        â†’ 35% markup for specialized service
```

## Email Breakdown Display

```
ADMIN EMAIL SUBJECT:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ New Lead: 123 Main St, Langley - $688-$791 (22km)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†‘              â†‘       â†‘
                     address         price   distance
                                    range    (NEW)

ADMIN EMAIL BODY (Key Parts):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Address: 123 Main St, Langley, BC                  â”‚
â”‚ Distance: 22km        â† NEW: Distance info         â”‚
â”‚ Stories: 2                                          â”‚
â”‚ Material: Stucco      â† NEW: Material info         â”‚
â”‚ Add-ons: Gutter Cleaning                           â”‚
â”‚                                                     â”‚
â”‚ Price Breakdown:      â† NEW: Detailed breakdown    â”‚
â”‚ - Base Price: $500                                 â”‚
â”‚ - Material Surcharge: $175.00                      â”‚
â”‚ - Travel Surcharge: $12.50    â† NEW: Travel item   â”‚
â”‚                                                     â”‚
â”‚ Estimated Range: $688 - $791                       â”‚
â”‚ Customer Email: customer@example.com               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

CUSTOMER EMAIL (HTML Table):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Base Service (2 stories):        $500.00          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Stucco Material Surcharge:       +$175.00         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Travel Surcharge (22km):         +$12.50          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Estimated Price Range:    $688 - $791             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

FRONTEND DISPLAY (Step 4):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Your Estimated Price                             â”‚
â”‚ $ 688 - $ 791                                    â”‚
â”‚                                                  â”‚
â”‚ Price Breakdown                                  â”‚
â”‚ Base Service (2 stories):      $500.00           â”‚
â”‚ Stucco Material Surcharge:     +$175.00          â”‚
â”‚ Travel Surcharge (22km):       +$12.50           â”‚
â”‚                                                  â”‚
â”‚ Distance: 22 km                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Real Calculation Examples

```
SCENARIO 1: Local Vinyl House
â”œâ”€ Address: 5km away
â”œâ”€ Stories: 1
â”œâ”€ Material: Vinyl
â”œâ”€
â”œâ”€ Base: $350 Ã— 1.0 = $350
â”œâ”€ Travel: $0 (under 20km)
â”œâ”€ Total: $350
â””â”€ Range: $350 - $403

SCENARIO 2: Mid-Distance Brick
â”œâ”€ Address: 28km away
â”œâ”€ Stories: 2
â”œâ”€ Material: Brick
â”œâ”€
â”œâ”€ Base: $500 Ã— 1.1 = $550
â”œâ”€ Travel: (28-20) Ã— $2.50 = $20
â”œâ”€ Total: $570
â””â”€ Range: $570 - $656

SCENARIO 3: Far Stucco Premium
â”œâ”€ Address: 40km away
â”œâ”€ Stories: 3
â”œâ”€ Material: Stucco
â”œâ”€
â”œâ”€ Base: $650 Ã— 1.35 = $877.50
â”œâ”€ Travel: (40-20) Ã— $2.50 = $50
â”œâ”€ Total: $927.50
â””â”€ Range: $928 - $1,067

SCENARIO 4: Outside Service Area
â”œâ”€ Address: 52km away
â”œâ”€ Stories: 2
â”œâ”€ Material: Vinyl
â”œâ”€
â””â”€ âŒ REJECTED (> 45km limit)
   â†’ Error message sent
   â†’ No quote generated
   â†’ No emails sent
```

## File Structure & Data Flow

```
/app
â”œâ”€ lib/
â”‚  â””â”€ pricing.ts â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     â€¢ calculateRouting()                         â”‚
â”‚     â€¢ calculateQuoteWithMaterial()               â”‚ Configuration
â”‚     â€¢ Material multipliers                       â”‚
â”‚     â€¢ Distance rules                             â”‚
â”‚     â€¢ Base rates                                 â”‚
â”‚                                                  â”‚
â”œâ”€ api/                                           â”‚
â”‚  â””â”€ quote/                                       â”‚
â”‚     â””â”€ route.ts â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚        â€¢ Imports pricing functions              â”‚ Uses pricing
â”‚        â€¢ Validates input                        â”‚ functions
â”‚        â€¢ Calls calculateRouting()               â”‚
â”‚        â€¢ Calls calculateQuoteWithMaterial()     â”‚
â”‚        â€¢ Sends emails                           â”‚
â”‚        â€¢ Returns breakdown                      â”‚
â”‚                                                  â”‚
â””â”€ components/                                     â”‚
   â””â”€ QuoteGenerator.tsx â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
      â€¢ Material selection UI                      â”‚ Calls API
      â€¢ Displays breakdown                         â”‚
      â€¢ Sends material field to API               â”‚
      â€¢ Shows routing info                        â”‚
      â€¢ Handles errors                            â”‚
```

---

This visual guide helps understand the complete flow from customer input to final quote display!
